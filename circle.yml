general:
  branches:
    ignore:
      - test-server
      - staging
      - production
machine:
  pre:
    - mkdir ~/.yarn-cache
    - mkdir -p ~/cache/bin
  node:
    version: 6.2.2
  environment:
    NODE_ENV: circleci
  services:
    - postgresql
dependencies:
  pre:
    - curl -o- -L https://yarnpkg.com/install.sh | bash
  cache_directories:
    - ~/.yarn-cache
    - ~/cache/bin
  override:
    - yarn install
test:
  override:
    - yarn test
deployment:
  staging:
    branch: staging
    heroku:
      appname: opencollective-staging-api
